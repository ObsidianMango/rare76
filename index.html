<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>ðŸ‘º Fasnacht Mask Checklist</title>
<link href="https://fonts.googleapis.com/css2?family=UnifrakturMaguntia&display=swap" rel="stylesheet">
<link rel="manifest" href="manifest.json">
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log("Service Worker Registered"));
    }
  </script>
  <style>
    /* Dark Theme Base */
    body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
      line-height: 1.5;
      background: #222;
      color: #ddd;
    }
    h1 { 
    font-family: 'UnifrakturMaguntia', cursive;

      text-align: center; 
      margin-bottom: 20px;
      color: #fff;
    }
    /* Controls for filtering, sorting and details toggle */
    #controls {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }
    #filterButtons, #sortDetailsContainer {
      display: flex;
      gap: 5px;
    }
    .filter-button, .toggle-button, .sort-button {
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
      background: #555;
      color: #fff;
      border: none;
      border-radius: 5px;
      transition: background 0.3s ease;
    }
    .filter-button.active {
      background: #39FF14;
      color: #222;
    }
    /* Glowing Text Effect */
    .glowing {
      color: #39FF14;
      text-shadow: 0 0 5px #39FF14, 0 0 10px #39FF14;
    }
    /* Additional classes for glowing image and title */
    .glowing--image {
      filter: drop-shadow(0 0 20px #39FF14) drop-shadow(0 0 30px #39FF14);
    }
    .glowing-title {
      color: #39FF14;
      text-shadow: 0 0 10px #39FF14, 0 0 20px #39FF14;
    }
    .mask-list {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      justify-content: center;
    }
    .mask-item {
      width: 150px;
      text-align: center;
      border: 1px solid #444;
      padding: 10px;
      border-radius: 5px;
      background: #333;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: pointer;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .mask-item.obtained {
      border-color: #39FF14;
    }
    .mask-item:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.5);
    }
    .mask-item img {
      max-width: 100%;
      height: 100px;
      object-fit: contain;
      display: block;
      margin: 0 auto 10px;
      border-radius: 3px;
    }
    .mask-item label {
      display: flex;
      height: 3.6em;
      align-items: center;
      justify-content: center;
      text-align: center;
      margin-bottom: 5px;
      font-weight: bold;
      pointer-events: none;
      color: #ddd;
    }
    .toggle-button {
      margin-top: 5px;
      padding: 5px 10px;
      font-size: 14px;
      cursor: pointer;
      background: #555;
      color: #fff;
      border: none;
      border-radius: 5px;
      transition: background 0.3s ease;
    }
    .toggle-button.active {
      background: #39FF14;
      color: #222;
    }
    .sort-button {
      min-width: 150px;
    }
    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      z-index: 100;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.85);
      align-items: center;
      justify-content: center;
    }
    .modal-close {
      position: absolute;
      top: 20px;
      right: 30px;
      font-size: 40px;
      color: #fff;
      cursor: pointer;
      z-index: 101;
    }
    .modal-container {
      position: relative;
      width: 90vw;
      height: 90vh;
    }
    /* Fixed image height so that spacing remains consistent */
    .modal-image {
      height: 70vh;
      width: auto;
      display: block;
      margin: 0 auto;
      object-fit: contain;
    }


    /* Overlay Text Styles with Animation â€“ increased font sizes */
    .overlay {
      position: absolute;
      font-size: 26px;
      text-shadow: 0 0 5px #000;
      background: rgba(0,0,0,0.4);
      padding: 8px 12px;
      border-radius: 5px;
          font-family: 'UnifrakturMaguntia', cursive;

    }
    .field-label {
      font-size: 36px;
      opacity: 0.8;
    }
    .field-value {
      font-size: 22px;
      font-weight: bold;
      margin-left: 4px;
    }
    /* Specific Overlay Positions and Colors */
    .modal-year {
      top: 20px;
      left: 20px;
      color: #00aced; /* Blue */
    }
    .modal-rarity {
      bottom: 70px;
      left: 20px;
      /* Color will be set dynamically */
    }
    .modal-drop {
      bottom: 70px;
      right: 20px;
      color: #f39c12; /* Orange */
    }
    .modal-title {
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
        font-family: 'UnifrakturMaguntia', cursive;

      font-size: 40px;
      text-align: center;
      color: #fff;
    }
    /* Copy Button Styles */
    #copyButton {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background: #555;
      color: #fff;
      border: none;
      border-radius: 5px;
    }
    #copyButton:hover {
      background: #777;
    }
    /* Mobile Friendly Styles */
    @media (max-width: 600px) {
      .mask-item {
        width: 100%;
      }
    }
    @media (max-width: 600px) and (orientation: portrait) {
  .modal-container {
    width: 100vw;
    height: auto;
    padding: 10px;
    box-sizing: border-box;
  }
  .modal-image {
    width: 100%;
    height: auto;
    max-height: 80vh;
    object-fit: contain;
    margin: 0 auto;
    display: block;
  }
  .overlay {
    font-size: 32px;
  }
}

  </style>
</head>
<body>
  <h1>ðŸ‘º Fasnacht Mask Checklist ðŸ¦„</h1>
  <div style="text-align: center; font-family: Arial, sans-serif; color: #555; font-size: 1.0em; margin:0px;">
  If mobile, <em>use landscape mode for best viewing results.</em>
</div>
<br>
  <div id="controls">
    <div id="filterButtons">
      <button class="filter-button active" data-filter="all">All</button>
      <button class="filter-button" data-filter="glowing">Glowing</button>
      <button class="filter-button" data-filter="rare">Rare</button>
      <button class="filter-button" data-filter="uncommon">Uncommon</button>
      <button class="filter-button" data-filter="common">Common</button>
    </div>
    <div id="sortDetailsContainer">
      <button id="sortButton" class="sort-button">Sort: Name â–²</button>
      <button id="detailsToggle" class="toggle-button">Hide Details</button>
    </div>
  </div>
  
  <div class="mask-list" id="maskList">
    <!-- Masks will be dynamically inserted here -->
  </div>
  
  <button id="copyButton">Copy Lists</button>

<div style="text-align:center;"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https://obsidianmango.github.io/rare76/index.html&count_bg=%2379C83D&title_bg=%23555555&icon=&title=visitors&edge_flat=false" alt="visitor count" /></div>

  <!-- Full-screen Modal (hidden on load) -->
  <div id="modal" class="modal" style="display:none;">
    <span id="modalClose" class="modal-close">&times;</span>
    <div class="modal-container">
      <img id="modalImg" class="modal-image" src="" alt="">
      <div id="modalYear" class="overlay modal-year"></div>
      <div id="modalRarity" class="overlay modal-rarity"></div>
      <div id="modalDropRate" class="overlay modal-drop"></div>
      <div id="modalTitle" class="overlay modal-title"></div>
    </div>
  </div>

  <script>
    // Animate text by scrambling then gradually revealing final text
    function animateText(element, finalText, duration = 800) {
      const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";
      let iterations = 0;
      const total = finalText.length;
      const interval = setInterval(() => {
        const displayed = finalText.split("").map((char, index) => {
          return index < iterations ? finalText[index] : letters[Math.floor(Math.random() * letters.length)];
        }).join("");
        element.textContent = displayed;
        iterations++;
        if (iterations > total) {
          clearInterval(interval);
          element.textContent = finalText;
        }
      }, duration / total);
    }
    
    // Helper function to remove unwanted text from titles
    function formatMaskTitle(title) {
      return title.replace(/Fallout\s*76/ig, '').replace(/in\s*Fo76/ig, '').trim();
    }
    
    // Sort modes: nameAsc, nameDesc, rarityAsc, rarityDesc, yearAsc, yearDesc
    const sortModes = ["nameAsc", "nameDesc", "rarityAsc", "rarityDesc", "yearAsc", "yearDesc"];
    let sortModeIndex = 0;
    let currentSort = sortModes[sortModeIndex];
    let showDetails = true;
    
    // Custom order for rarity
    const rarityOrder = {
      "glowing": 1,
      "rare": 2,
      "uncommon": 3,
      "common": 4
    };
    
    const maskData = [
      {
        "name": "Alien Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-alien-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Beret",
        "url": "https://images.fallout.wiki/thumb/4/47/FO76_fasnacht_beret.png/155px-FO76_fasnacht_beret.png",
        "year": 2019,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Big Foot Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/big.png",
        "year": 2025,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Blue Devil Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-blue-devil-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Brahmin Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-brahmin-mask.webp",
        "year": 2021,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Buffoon Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-buffoon-mask.webp",
        "year": 2021,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Crazy Guy Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-crazy-guy-mask.webp",
        "year": 2020,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Deathclaw Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-deathclaw-mask.webp",
        "year": 2020,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Demon Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-demon-mask.webp",
        "year": 2020,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Fiend Mask",
        "url": "https://images.fallout.wiki/thumb/e/ea/FO76_headwear_fasnacht_fiend.png/600px-FO76_headwear_fasnacht_fiend.png",
        "year": 2022,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Giant Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-giant-mask.webp",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      },
      {
        "name": "Goblin Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-goblin-mask.webp",
        "year": 2019,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Glowing Abe Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/abeglow.png",
        "year": 2025,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Alien Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-alien-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Big Foot Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/bigglow.png",
        "year": 2025,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Blue Devil Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-blue-devil-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Honey Bee Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-honey-bee-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Jackalope Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/jackglow.png",
        "year": 2025,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Minotaur Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-minotaur-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Pig Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-pig-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Robot Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-robot-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Scorchbeast Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-scorchbeast-mask-.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Scorchbeast Queen Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-scorchbeast-queen-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Turkey Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-turkey-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Unicorn Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-glowing-unicorn-mask.webp",
        "year": 2024,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Glowing Veggie Man Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/vegglow.png",
        "year": 2025,
        "rarity": "glowing",
        "dropRate": 0.2
      },
      {
        "name": "Hag Mask",
        "url": "https://images.fallout.wiki/b/b0/FO76_headwear_fasnacht_hag.png",
        "year": 2022,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Honey Bee Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-honey-bee-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Jackalope Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/jack.png",
        "year": 2025,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Jester Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-jester-mask.webp",
        "year": 2019,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Loon Mask",
        "url": "https://raw.githubusercontent.com/ObsidianMango/ObsidianMango/main/img/loon.png",
        "year": 2024,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Man Mask",
        "url": "https://images.fallout.wiki/b/be/Faschnacht_Man_Mask.png",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      },
      {
        "name": "Minotaur Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-minotaur-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Owl Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-owl-mask.webp",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      },
      {
        "name": "Pig Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-pig-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Raven Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-raven-mask.webp",
        "year": 2020,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Robot Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-robot-mask.webp",
        "year": 2024,
        "rarity": "common",
        "dropRate": 4.4
      },
      {
        "name": "Scorchbeast Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-scorchbeast-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 0.2
      },
      {
        "name": "Scorchbeast Queen Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-scorchbeast-queen-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Skull Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-skull-mask.webp",
        "year": 2019,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Soldier Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-soldier-mask.webp",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      },
      {
        "name": "Sun Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-sun-mask.webp",
        "year": 2019,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Toothy Man Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-toothy-man-mask.webp",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      },
      {
        "name": "Turkey Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-turkey-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Unicorn Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-unicorn-mask.webp",
        "year": 2024,
        "rarity": "uncommon",
        "dropRate": 4.4
      },
      {
        "name": "Winter Man Mask",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-winter-man-mask.webp",
        "year": 2021,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Winter Man T-45 Helmet",
        "url": "https://images.fallout.wiki/thumb/c/c8/FO76WL_Father_Winter_helmet.png/155px-FO76WL_Father_Winter_helmet.png",
        "year": 2021,
        "rarity": "rare",
        "dropRate": 0.2
      },
      {
        "name": "Witch Mask ",
        "url": "https://www.falloutbuilds.com/wp-content/uploads/sites/41/fallout-76-fasnacht-witch-mask.webp",
        "year": 2019,
        "rarity": "common",
        "dropRate": 20.0
      }
    ];
    
    let savedData = JSON.parse(localStorage.getItem("fasnachtMasks") || "[]");
    if (savedData.length) {
      maskData.forEach((mask, i) => {
        if (savedData[i]) mask.obtained = savedData[i].obtained;
      });
    }
    
    function saveChecklist() {
      localStorage.setItem("fasnachtMasks", JSON.stringify(maskData));
    }
    
    function renderMaskList() {
      const maskList = document.getElementById("maskList");
      maskList.innerHTML = "";
      let filteredData = maskData.filter(mask => activeFilter === "all" || mask.rarity === activeFilter);
      
      // Sorting based on currentSort value
      if(currentSort === "nameAsc") {
        filteredData.sort((a, b) => formatMaskTitle(a.name).localeCompare(formatMaskTitle(b.name)));
      } else if(currentSort === "nameDesc") {
        filteredData.sort((a, b) => formatMaskTitle(b.name).localeCompare(formatMaskTitle(a.name)));
      } else if(currentSort === "rarityAsc") {
        filteredData.sort((a, b) => (rarityOrder[a.rarity.toLowerCase()] || 99) - (rarityOrder[b.rarity.toLowerCase()] || 99));
      } else if(currentSort === "rarityDesc") {
        filteredData.sort((a, b) => (rarityOrder[b.rarity.toLowerCase()] || 99) - (rarityOrder[a.rarity.toLowerCase()] || 99));
      } else if(currentSort === "yearAsc") {
        filteredData.sort((a, b) => a.year - b.year);
      } else if(currentSort === "yearDesc") {
        filteredData.sort((a, b) => b.year - a.year);
      }
      
      filteredData.forEach((mask, index) => {
        maskList.appendChild(createMaskItem(mask, index));
      });
    }
    
    function createMaskItem(mask, index) {
      const container = document.createElement("div");
      container.className = "mask-item";
      if(mask.obtained) container.classList.add("obtained");
    
      const img = document.createElement("img");
      img.src = mask.url;
      img.alt = mask.name;
      img.addEventListener("click", (e) => {
        e.stopPropagation();
        openModal(mask);
      });
    
      // Only add label and details if showDetails is true
      if(showDetails) {
        const label = document.createElement("label");
        label.textContent = formatMaskTitle(mask.name);
        if(mask.rarity.toLowerCase() === "glowing") {
          label.classList.add("glowing");
        }
    
        const details = document.createElement("div");
        details.style.fontSize = "12px";
        details.innerHTML = "Year: " + mask.year + "<br>Drop: " + mask.dropRate + "%";
    
        container.appendChild(label);
        container.appendChild(details);
      }
    
      const toggleButton = document.createElement("button");
      toggleButton.className = "toggle-button";
      toggleButton.textContent = mask.obtained ? "Obtained" : "Not Obtained";
      if(mask.obtained) toggleButton.classList.add("active");
      toggleButton.addEventListener("click", (e) => {
        e.stopPropagation();
        mask.obtained = !mask.obtained;
        toggleButton.textContent = mask.obtained ? "Obtained" : "Not Obtained";
        toggleButton.classList.toggle("active", mask.obtained);
        container.classList.toggle("obtained", mask.obtained);
        saveChecklist();
      });
    
      container.appendChild(img);
      container.appendChild(toggleButton);
    
      container.addEventListener("click", () => {
        openModal(mask);
      });
    
      return container;
    }
    
    function openModal(mask) {
      const modal = document.getElementById("modal");
      const modalImg = document.getElementById("modalImg");
      modal.style.display = "flex";
      modalImg.src = mask.url;
      modalImg.alt = mask.name;
      
      // Animate text overlays with scrambled effect;
      // make drop rate animation last longer (1200ms)
      animateText(document.getElementById("modalYear"), "  " + mask.year, 800);
      animateText(document.getElementById("modalDropRate"), "Drop Rate: " + mask.dropRate + "%", 1200);
      animateText(document.getElementById("modalRarity"), mask.rarity, 800);
      animateText(document.getElementById("modalTitle"), formatMaskTitle(mask.name), 800);
      
      // Dynamically set rarity overlay color and add glowing effects for glowing masks
      const modalRarity = document.getElementById("modalRarity");
      let rarity = mask.rarity.toLowerCase();
      let rarityColor = "#fff";
      if(rarity === "rare") {
         rarityColor = "#ff5555";
      } else if(rarity === "uncommon") {
         rarityColor = "#55ff55";
      } else if(rarity === "glowing") {
         rarityColor = "#39FF14";
      } else if(rarity === "common") {
         rarityColor = "#ffffff";
      }
      modalRarity.style.color = rarityColor;
    
      if(rarity === "glowing") {
        document.getElementById("modalYear").classList.add("glowing");
        document.getElementById("modalDropRate").classList.add("glowing");
        document.getElementById("modalRarity").classList.add("glowing");
        document.getElementById("modalTitle").classList.add("glowing");
        modalImg.classList.add("glowing-image");
        document.getElementById("modalTitle").classList.add("glowing-title");
      } else {
        document.getElementById("modalYear").classList.remove("glowing");
        document.getElementById("modalDropRate").classList.remove("glowing");
        document.getElementById("modalRarity").classList.remove("glowing");
        document.getElementById("modalTitle").classList.remove("glowing");
        modalImg.classList.remove("glowing-image");
        document.getElementById("modalTitle").classList.remove("glowing-title");
      }
    }
    
    function closeModal() {
      document.getElementById("modal").style.display = "none";
    }
    
    document.getElementById("modalClose").addEventListener("click", closeModal);
    document.getElementById("modal").addEventListener("click", (e) => {
      if (e.target === e.currentTarget) closeModal();
    });
    
    let activeFilter = "all";
    
    document.querySelectorAll(".filter-button").forEach(button => {
      button.addEventListener("click", () => {
        activeFilter = button.getAttribute("data-filter");
        document.querySelectorAll(".filter-button").forEach(btn => btn.classList.remove("active"));
        button.classList.add("active");
        renderMaskList();
      });
    });
    
    // Sort button cycles through:
    // Name â–², Name â–¼, Rarity â–², Rarity â–¼, Year â–², Year â–¼
    document.getElementById("sortButton").addEventListener("click", () => {
      sortModeIndex = (sortModeIndex + 1) % sortModes.length;
      currentSort = sortModes[sortModeIndex];
      let sortText = "";
      if(currentSort === "nameAsc") sortText = "Name â–²";
      else if(currentSort === "nameDesc") sortText = "Name â–¼";
      else if(currentSort === "rarityAsc") sortText = "Rarity â–²";
      else if(currentSort === "rarityDesc") sortText = "Rarity â–¼";
      else if(currentSort === "yearAsc") sortText = "Year â–²";
      else if(currentSort === "yearDesc") sortText = "Year â–¼";
      document.getElementById("sortButton").textContent = "Sort: " + sortText;
      renderMaskList();
    });
    
    // Details toggle button to show/hide name and details on mask tiles
    document.getElementById("detailsToggle").addEventListener("click", () => {
      showDetails = !showDetails;
      document.getElementById("detailsToggle").textContent = showDetails ? "Hide Details" : "Show Details";
      renderMaskList();
    });
    
    document.getElementById("copyButton").addEventListener("click", () => {
      const ownedMasks = [];
      const unownedMasks = [];
      maskData.forEach(mask => {
        const formattedName = formatMaskTitle(mask.name);
        if (mask.obtained) ownedMasks.push(formattedName);
        else unownedMasks.push(formattedName);
      });
      const textToCopy =
        "Owned Masks:\n" + (ownedMasks.length ? ownedMasks.join("\n") : "None") +
        "\n\nUnowned Masks:\n" + (unownedMasks.length ? unownedMasks.join("\n") : "None");
      navigator.clipboard.writeText(textToCopy)
        .then(() => alert("Copied to clipboard!"))
        .catch(() => alert("Failed to copy."));
    });
    
    renderMaskList();

  </script>

</body>
</html>
